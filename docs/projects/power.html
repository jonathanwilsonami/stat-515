<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-12-10">

<title>Identifying High-Demand Utilities in Virginia: Statistical Learning and National Comparative Analysis in the Era of Data Centers – Stat 515</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-cbd51242bb15cf1db6e2d2b8b2a9f477.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
      

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Stat 515</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-projects" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Projects</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-projects">    
        <li>
    <a class="dropdown-item" href="../projects/index.html">
 <span class="dropdown-text">All Projects</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../projects/crime-and-poverty.html">
 <span class="dropdown-text">Mid Term Redesign</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../projects/crime-and-poverty-CODE.html">
 <span class="dropdown-text">Mid Term Redesign - CODE</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../projects/power.html">
 <span class="dropdown-text">Final Project</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../projects/powerCODE.html">
 <span class="dropdown-text">Final Project - CODE</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#abstract" id="toc-abstract" class="nav-link active" data-scroll-target="#abstract"><span class="header-section-number">1</span> Abstract</a></li>
  <li><a href="#introduction-background" id="toc-introduction-background" class="nav-link" data-scroll-target="#introduction-background"><span class="header-section-number">2</span> Introduction &amp; Background</a>
  <ul class="collapse">
  <li><a href="#motivation" id="toc-motivation" class="nav-link" data-scroll-target="#motivation"><span class="header-section-number">2.1</span> Motivation</a></li>
  <li><a href="#virginias-internet-data-boom" id="toc-virginias-internet-data-boom" class="nav-link" data-scroll-target="#virginias-internet-data-boom"><span class="header-section-number">2.2</span> Virginia’s Internet &amp; Data Boom</a></li>
  <li><a href="#virginias-power-demands-hyperscalers-demand-for-data" id="toc-virginias-power-demands-hyperscalers-demand-for-data" class="nav-link" data-scroll-target="#virginias-power-demands-hyperscalers-demand-for-data"><span class="header-section-number">2.3</span> Virginia’s Power Demands &amp; Hyperscaler’s Demand for Data</a></li>
  <li><a href="#the-fragile-power-grid" id="toc-the-fragile-power-grid" class="nav-link" data-scroll-target="#the-fragile-power-grid"><span class="header-section-number">2.4</span> The Fragile Power Grid</a></li>
  <li><a href="#what-our-research-contributes" id="toc-what-our-research-contributes" class="nav-link" data-scroll-target="#what-our-research-contributes"><span class="header-section-number">2.5</span> What Our Research Contributes</a></li>
  </ul></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">3</span> Data</a>
  <ul class="collapse">
  <li><a href="#dataset-overview" id="toc-dataset-overview" class="nav-link" data-scroll-target="#dataset-overview"><span class="header-section-number">3.1</span> Dataset Overview</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations"><span class="header-section-number">3.2</span> Limitations</a></li>
  <li><a href="#data-cleaning-processing-assumptions" id="toc-data-cleaning-processing-assumptions" class="nav-link" data-scroll-target="#data-cleaning-processing-assumptions"><span class="header-section-number">3.3</span> Data Cleaning, Processing &amp; Assumptions</a></li>
  <li><a href="#derived-features---feature-engineering" id="toc-derived-features---feature-engineering" class="nav-link" data-scroll-target="#derived-features---feature-engineering"><span class="header-section-number">3.4</span> Derived Features - Feature Engineering</a></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis"><span class="header-section-number">3.5</span> Exploratory Data Analysis</a></li>
  </ul></li>
  <li><a href="#research-questions" id="toc-research-questions" class="nav-link" data-scroll-target="#research-questions"><span class="header-section-number">4</span> Research Questions</a>
  <ul class="collapse">
  <li><a href="#building-classifiers" id="toc-building-classifiers" class="nav-link" data-scroll-target="#building-classifiers"><span class="header-section-number">4.1</span> Building Classifiers</a></li>
  <li><a href="#predictive-modeling-of-high-load-utility-distribution-and-state-level-dominance" id="toc-predictive-modeling-of-high-load-utility-distribution-and-state-level-dominance" class="nav-link" data-scroll-target="#predictive-modeling-of-high-load-utility-distribution-and-state-level-dominance"><span class="header-section-number">4.2</span> Predictive Modeling of High-Load Utility Distribution and State-Level Dominance</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">5</span> Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">6</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Identifying High-Demand Utilities in Virginia: Statistical Learning and National Comparative Analysis in the Era of Data Centers</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Data Centers</div>
    <div class="quarto-category">Power Grid</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Jonathan Wilson </p>
             <p>Sean Reilly </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 10, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="abstract" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="abstract"><span class="header-section-number">1</span> Abstract</h2>
<p>The rapid expansion of data centers in Virginia has raised concerns about rising electricity consumption and shifting load patterns especially in northern counties of the state. This study leverages a statistical learning approach to identify <em>high-demand</em> electric utilities and to compare Virginia’s demand characteristics with national trends. Using ten years of U.S. Energy Information Administration (EIA-861) data, we construct engineered features such as commercial sales ratios, per-customer intensity metrics, and loss ratios—and compute a composite <strong>Intensity Score</strong> to classify utilities exhibiting unusually high load profiles.</p>
<p>Multiple supervised models are evaluated, including logistic regression, standardized logistic regression, ridge-penalized logistic regression, classification trees, random forests, and K-nearest neighbors. Unsupervised methods (PCA and K-means) further reveal multivariate structure and clustering patterns among utilities. Findings show that while raw and standardized logistic models suffer from severe separation and unstable coefficient estimates, ridge logistic regression and tree-based models provide the most reliable predictive performance. When applied to 2023 data, the ridge model identifies Virginia as having a relatively high concentration of load-intensive utilities once weighted by retail sales and commercial activity, aligning with observed data center growth.</p>
<p>The study demonstrates how statistically rigorous, machine-learning-based classification can quantify evolving electricity demand patterns and provide state-level comparisons relevant to infrastructure planning. Limitations include incomplete utility-level metadata, non-uniform reporting across states, and the inability to observe direct data center loads. Nevertheless, the results provide a replicable framework for evaluating future changes in grid demand as data center development continues.</p>
</section>
<section id="introduction-background" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="introduction-background"><span class="header-section-number">2</span> Introduction &amp; Background</h2>
<section id="motivation" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="motivation"><span class="header-section-number">2.1</span> Motivation</h3>
<p>Over the past few decades, technological output has risen steadily. That gradual climb transformed into exponential growth with the advent of cloud computing, and now with the acceleration of the AI era that trajectory is poised to surge even faster. This rapid expansion is widely recognized. What’s far less understood, however, is the critical infrastructure that makes all of it possible. At the center of this digital revolution lies the often overlooked backbone of modern society: the power grid. It is the heartbeat of every computation, the lifeblood behind the flow of ones and zeros. Without this essential utility the modern world as we know it would come to a halt. And no where is that more true than in the state of Virginia.</p>
</section>
<section id="virginias-internet-data-boom" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="virginias-internet-data-boom"><span class="header-section-number">2.2</span> Virginia’s Internet &amp; Data Boom</h3>
<p>Over the past several decades, Virginia has evolved from a strategically located government corridor into the epicenter of the modern internet. This transformation began in the early 1990s, when the Metropolitan Area Exchange–East (MAE-East)—one of the original four Network Access Points funded by the National Science Foundation—was established in Northern Virginia. Its proximity to federal agencies and research institutions such as DARPA, whose ARPANET project laid the foundations for the internet, positioned the region as a natural hub for digital networks. Over time, transatlantic subsea cable systems like MAREA-BRUSA, landing in Virginia Beach, further strengthened the state’s role in global connectivity <span class="citation" data-cites="data-center-capital"><a href="#ref-data-center-capital" role="doc-biblioref">[1]</a></span>.</p>
<p>Today, that historical advantage has scaled into an unmatched concentration of data centers, making Virginia the digital heart of the world. An estimated 70% of global internet IP traffic is created in or routed through Loudoun County’s famed “Data Center Alley,” cementing Ashburn as the world’s central point for cloud and interconnection <span class="citation" data-cites="dawn-of-data"><a href="#ref-dawn-of-data" role="doc-biblioref">[2]</a></span>. Virginia now hosts the largest cluster of data centers anywhere on Earth—surpassing Texas, California, and Illinois—with rapid expansion fueled by skyrocketing demand for cloud computing, AI workloads, and global digital services <span class="citation" data-cites="cushman"><a href="#ref-cushman" role="doc-biblioref">[3]</a></span>. This boom is supported in part by Dominion Energy’s historically competitive electricity prices, which helped attract and retain power-intensive facilities. But it also places unprecedented strain on the state’s power grid: the very infrastructure that sustains the flow of computation. As AI and cloud demands continue to accelerate, Virginia’s electricity consumption is set to become one of the most consequential factors shaping both its economic future and the stability of its energy systems <span class="citation" data-cites="data-center-capital"><a href="#ref-data-center-capital" role="doc-biblioref">[1]</a></span>.</p>
</section>
<section id="virginias-power-demands-hyperscalers-demand-for-data" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="virginias-power-demands-hyperscalers-demand-for-data"><span class="header-section-number">2.3</span> Virginia’s Power Demands &amp; Hyperscaler’s Demand for Data</h3>
<p>Virginia’s data center ecosystem has expanded at an unprecedented pace, driven largely by the accelerating demand for cloud computing and AI workloads. With more than 24,000 megawatts of planned data center capacity, Virginia surpasses every other market in the world—by more than a factor of three—in total expected power demand <span class="citation" data-cites="cushman"><a href="#ref-cushman" role="doc-biblioref">[3]</a></span>. This explosive growth reflects the state’s long-standing role as the heart of global internet traffic, as well as its strategic appeal to the companies building the modern digital economy. Nowhere is this more evident than in Northern Virginia, where annual data center absorption has shattered global records; the region reached 270 MW of bookings in 2018, while no other market worldwide has ever exceeded 70 MW in a single year <span class="citation" data-cites="dawn-of-data"><a href="#ref-dawn-of-data" role="doc-biblioref">[2]</a></span>.</p>
<p>At the center of this surge are the hyperscalers<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, or in other words major cloud and platform providers such as Microsoft, Google, Meta (Facebook), Apple, Oracle, IBM, Yahoo!, LinkedIn, Alibaba, Uber, and Dropbox. These companies require immense and rapidly scalable infrastructure, with hyperscale leases often ranging from 10 to 20 megawatts or more for a single deployment. The resulting demand for data is fueled by the relentless expansion of e-commerce, wireless networks, social media, streaming content, SaaS platforms, artificial intelligence, machine learning, gaming, virtual reality, and the Internet of Things. Collectively, these forces make Virginia not just a data center leader, but the world’s central engine for digital power consumption <span class="citation" data-cites="data-center-capital"><a href="#ref-data-center-capital" role="doc-biblioref">[1]</a></span>.</p>
</section>
<section id="the-fragile-power-grid" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="the-fragile-power-grid"><span class="header-section-number">2.4</span> The Fragile Power Grid</h3>
<p>The power grid is essentially a giant, interconnected system that moves electricity from where it’s generated to where it’s needed. Power plants feed electricity into long-distance high-voltage transmission lines, which deliver power to substations where transformers reduce the voltage for safe distribution to homes, businesses, and—more recently—massive data centers. Because electricity cannot be stored easily at grid scale, supply and demand must remain in perfect balance at every moment. This requires constant coordination among utilities, transmission operators, and regional balancing authorities to maintain stability. When demand surges faster than supply, the grid becomes stressed, increasing the risk of brownouts or outages <span class="citation" data-cites="power-grid"><a href="#ref-power-grid" role="doc-biblioref">[4]</a></span>.</p>
<p>This balancing act becomes especially challenging in states like Virginia, where hyperscale data centers consume tens of megawatts each—orders of magnitude more than typical commercial users. As Virginia has become home to the world’s largest concentration of data centers, the strain on its power system has expanded accordingly. Each new facility adds continuous, around-the-clock demand that the grid must support without interruption. This is why long-term planning for new generation, transmission upgrades, and regional reliability is becoming central to Virginia’s energy future: the digital infrastructure powering cloud computing, AI, and global internet traffic can only grow if the physical grid underneath it can keep up.</p>
<p>To understand how these pressures play out across the country, it is helpful to situate Virginia within the broader structure of the United States energy landscape. The graphic below shows the U.S. Census Regions and Divisions, which group the nation into four major regions and nine divisions commonly used for national energy, economic, and demographic analysis.</p>
<div id="fig-regions-divisions" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-regions-divisions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../images/power-grid/us-census-regions-and-divisions.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-regions-divisions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: U.S. Census Regions and Divisions[^refnote].
</figcaption>
</figure>
</div>
</section>
<section id="what-our-research-contributes" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="what-our-research-contributes"><span class="header-section-number">2.5</span> What Our Research Contributes</h3>
<p>Taken together, Virginia’s outsized role in global internet infrastructure, the explosive growth of hyperscale data centers, and the increasing fragility of the power grid form the backdrop for the analysis that follows. As demand for AI, cloud computing, and digital services accelerates, understanding how this demand translates into regional electricity usage becomes critical—not only for Virginia but for the nation. This study seeks to examine how Virginia’s utilities compare to those across the United States, identify whether data-center-driven growth produces distinctive load patterns, and explore the emerging pressures placed on the grid as a result. By combining national utility data with Virginia-specific trends, our goal is to measure where Virginia stands today, how its electricity profile is changing, and what these shifts may imply for energy planning, reliability, and the future of the digital economy.</p>
</section>
</section>
<section id="data" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="data"><span class="header-section-number">3</span> Data</h2>
<section id="dataset-overview" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="dataset-overview"><span class="header-section-number">3.1</span> Dataset Overview</h3>
<p>For this analysis we used the Annual Electric Power Industry Report (Form EIA-861) which is a U.S. government survey (considered the Census for Utilities) conducted by the Energy Information Administration (EIA) that collects detailed data from electric utilities on retail sales, revenue, and other key aspects of the electric power industry. It provides information on energy sources, demand-side management, net-metering, and other operational data to help monitor the industry’s status and trends <span class="citation" data-cites="original-eia-data"><a href="#ref-original-eia-data" role="doc-biblioref">[5]</a></span>.</p>
<p>Originally we wanted to know about the impact of data centers in local communities in northern VA, had reached out to several city planners, they responded back but revealed that getting specific data on individual data centers would require coordination with individual commercial power supply companies and the individual data centers themselves which would be difficult or impossible to obtain given various NDAs that would need to be signed and potential limitations on what we could share. Alas, the annually released data that is generated compiled by the EIA contains the main companies we are interested in at least their bulk aggregated numbers which will be discussed later. For example, doing a little research online revealed that the utility named Virginia Electric &amp; Power Co which is found in the data is really part of Dominion Energy which is one of the biggest power utilities in Virginia. The dataset also allows for studying behavioral indicators identifying utilities that exhibit data center like pattern such as:</p>
<ul>
<li>High commercial load</li>
<li>Very high commercial electricity sales</li>
<li>Large sales per customer</li>
<li>High commercial sales per commercial customer</li>
</ul>
<p>These variables become proxies for “data-center–like” behavior.</p>
<p>A data dictionary<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> of the various data elements used in this analysis can also be referenced.</p>
</section>
<section id="limitations" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="limitations"><span class="header-section-number">3.2</span> Limitations</h3>
<p>The dataset does have some obvious limitations. For one, we are looking at a yearly aggregation of data which provides a very course view of the data. This limitation does now allow us to view individual data centers or even the break down of the individual contributors of what make up a utility. There might be some missing data points as well. Some private commercial companies might not have released certain data in the survey which might leave gaps in the analysis and greatly impact the value of our model’s predictions. Despite these limitations, the EIA-861 data has been used in several analysis reports and can be viewed as a reliable data source for understanding macro trends seen in the United States power grid. Later on in the analysis section we will construct various methods of overcoming these limitations however crude they might be.</p>
</section>
<section id="data-cleaning-processing-assumptions" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="data-cleaning-processing-assumptions"><span class="header-section-number">3.3</span> Data Cleaning, Processing &amp; Assumptions</h3>
<p>We initially started our analysis on the 2017 EIA-861 curated dataset developed by the CORGIS Dataset Project <span class="citation" data-cites="data-dictionary"><a href="#ref-data-dictionary" role="doc-biblioref">[6]</a></span>. However, when comparing the numbers for 2017 to the original data source the numbers were off. This might have been due to updates to upstream data that never reached the curated dataset. After this discovery we created a python script to regenerate the same exact dataset (same fields as the CORGIS Dataset) not only for 2017 but for 10 years worth of data. So 2015 to 2015. This script basically parsed each of the zipped files from source and extracted data from 3 different schedules:</p>
<ol type="1">
<li><strong>Operational Data</strong> - The data containing aggregate operational data for the source and disposition of energy and revenue information from each electric utility.</li>
<li><strong>Utility Data</strong> - The data containing information on a utility’s North American Electric Reliability (NERC) regions of operation. The data also indicate a utility’s independent system operator (ISO) or regional transmission organization (RTO) and whether that utility is engaged in any of the following activities: generation, transmission, buying transmission, distribution, buying distribution, wholesale marketing, retail marketing, bundled service, or operating alternative-fueled vehicles.</li>
<li><strong>Sales to Ultimate Customers</strong> - The data containing revenue, sales (in megawatthours), and customer count of electricity delivered to end-use customers by state, sector, and balancing authority. A state, service type, and balancing authority-level adjustment is made for non-respondents and for customer-sited respondents.</li>
</ol>
<p>When it comes to data cleaning we had to handle the following and make some assumptions:</p>
<ul>
<li>In EIA-861 spreadsheets a dot (.) could represent data that was suppressed (as mentioned before with private companies), not available, or did not meet a certain threshold value. For these values we decided to make zero but might use some form of data imputation to fill these in.</li>
<li>We found only a handful of empty values in the state field. We dropped these rows as knowing where the utility is located was critical to the analysis.</li>
</ul>
</section>
<section id="derived-features---feature-engineering" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="derived-features---feature-engineering"><span class="header-section-number">3.4</span> Derived Features - Feature Engineering</h3>
<p>We define the following engineered variables used throughout the analysis. Much of these variables are based on potentially biased opinions of what we might expect a data center like conditions to look like.</p>
<section id="commercial-ratio" class="level4" data-number="3.4.1">
<h4 data-number="3.4.1" class="anchored" data-anchor-id="commercial-ratio"><span class="header-section-number">3.4.1</span> Commercial Ratio</h4>
<p>Measures how much of a utility’s total load comes from the commercial sector. High ratios suggest large commercial customers such as data centers. <span class="math display">\[
\text{Commercial\_Ratio}
\;=\;
\frac{\text{Commercial Sales}}{\text{Total Sales}}
\]</span></p>
</section>
<section id="sales-per-customer" class="level4" data-number="3.4.2">
<h4 data-number="3.4.2" class="anchored" data-anchor-id="sales-per-customer"><span class="header-section-number">3.4.2</span> Sales per Customer</h4>
<p>Captures average consumption intensity across all customers. We would expect data centers to produce extremely high sales relative to customer count, making this a strong signal. <span class="math display">\[
\text{SalesPerCustomer}
\;=\;
\frac{\text{Total Sales}}{\text{Total Customers}}
\]</span></p>
</section>
<section id="commercial-sales-per-commercial-customer-spc" class="level4" data-number="3.4.3">
<h4 data-number="3.4.3" class="anchored" data-anchor-id="commercial-sales-per-commercial-customer-spc"><span class="header-section-number">3.4.3</span> Commercial Sales per Commercial Customer (SPC)</h4>
<p>Measures electricity use per commercial customer. Data centers typically appear as a small number of commercial customers with very high consumption, pushing this metric upward. <span class="math display">\[
\text{Commercial\_SPC}
\;=\;
\frac{\text{Commercial Sales}}{\text{Commercial Customers}}
\]</span></p>
</section>
<section id="losses-ratio" class="level4" data-number="3.4.4">
<h4 data-number="3.4.4" class="anchored" data-anchor-id="losses-ratio"><span class="header-section-number">3.4.4</span> Losses Ratio</h4>
<p>Represents distribution and transmission losses relative to total usage. Extremely high-volume industrial or data center load can shift loss<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> patterns on the grid.<span class="citation" data-cites="power-loss"><a href="#ref-power-loss" role="doc-biblioref">[7]</a></span> <span class="math display">\[
\text{Losses\_Ratio}
\;=\;
\frac{\text{Losses}}{\text{Total Uses}}
\]</span></p>
</section>
<section id="log-transformed-size-features" class="level4" data-number="3.4.5">
<h4 data-number="3.4.5" class="anchored" data-anchor-id="log-transformed-size-features"><span class="header-section-number">3.4.5</span> Log-Transformed Size Features</h4>
<p>Log transforms stabilize variance and capture utility scale without being dominated by extreme outliers. During our EDA we discovered some issues with the data. Total customers and total sales vary by several orders of magnitude across U.S. utilities. Some are tiny rural co-ops; others (like Dominion) serve millions. The log transformation helps to mitigate these skewness issues and improves stablity in our modeling. In this study, logging these variables prevents large utilities from overwhelming the models and provides more interpretable patterns across the full national dataset. <span class="math display">\[
\log(\text{Total\_Customers}),
\qquad
\log(\text{Total\_Sales})
\]</span></p>
<hr>
</section>
<section id="composite-intensity-score" class="level4" data-number="3.4.6">
<h4 data-number="3.4.6" class="anchored" data-anchor-id="composite-intensity-score"><span class="header-section-number">3.4.6</span> Composite Intensity Score</h4>
<p>Combines three load-intensity metrics (Commercial Ratio, SPC, SalesPerCustomer) into a single standardized indicator of “data-center–like” consumption profiles.</p>
<p>Each variable above is standardized to a z-score. The composite <em>Intensity Score</em> is then defined as:</p>
<p><span class="math display">\[
\text{IntensityScore}
\;=\;
z(\text{Commercial\_Ratio})
\;+\;
z(\text{SalesPerCustomer})
\;+\;
z(\text{Commercial\_SPC})
\]</span></p>
<hr>
</section>
<section id="high-demand-label" class="level4" data-number="3.4.7">
<h4 data-number="3.4.7" class="anchored" data-anchor-id="high-demand-label"><span class="header-section-number">3.4.7</span> High-Demand Label</h4>
<p>Identifies the top decile of utilities exhibiting exceptionally intense commercial electricity use those most likely associated with data center load characteristics.</p>
<p>Utilities falling in the <strong>top 10%</strong> of the Intensity Score distribution are classified as high-demand:</p>
<p><span class="math display">\[
\text{HighDemand} = 1
\quad\text{if}\quad
\text{IntensityScore} \ge Q_{0.90}(\text{IntensityScore})
\]</span></p>
<p>and otherwise:</p>
<p><span class="math display">\[
\text{HighDemand} = 0
\]</span></p>
</section>
</section>
<section id="exploratory-data-analysis" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="exploratory-data-analysis"><span class="header-section-number">3.5</span> Exploratory Data Analysis</h3>
<p>The number of reporting utilities varies substantially by state.<br>
Figure <a href="#fig-state-utilities" class="quarto-xref">Figure&nbsp;2</a> shows the distribution of utilities across states in 2023, with <strong>Virginia highlighted</strong> for comparison. As you can see, Texas, California and New York are highly skewed and represent the vast majority of the number of utilities. In order to compare Virginia to the rest of the states we will need to handle this.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-state-utilities" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-state-utilities-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-state-utilities-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-state-utilities-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Number of utilities per state in 2023, with Virginia highlighted.
</figcaption>
</figure>
</div>
</div>
</div>
<p>We also examine the mix of utility business types (investor-owned, municipal, cooperative, etc.).<br>
Figure <a href="#fig-utility-types" class="quarto-xref">Figure&nbsp;3</a> summarizes the <strong>count of utilities by type</strong> in 2023. For this particular study we are interested mostly in Investor Owned, Cooperative and Retail Power Marketers but we will consider all utilities.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-utility-types" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-utility-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-utility-types-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-utility-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Number of utilities by type in 2023.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure <a href="#fig-num-var-distributions" class="quarto-xref">Figure&nbsp;4</a> shows the skewed nature of the raw variables. Log-transforming the data (Figure <a href="#fig-num-var-distributions-log" class="quarto-xref">Figure&nbsp;5</a>) improves interpretability.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-num-var-distributions" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-num-var-distributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-num-var-distributions-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-num-var-distributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Distributions of key electricity variables in 2023 (original scale).
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-num-var-distributions-log" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-num-var-distributions-log-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-num-var-distributions-log-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-num-var-distributions-log-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Distributions of key electricity variables in 2023 (log10 scale).
</figcaption>
</figure>
</div>
</div>
</div>
<p>Sector composition across utilities varies widely (Figure <a href="#fig-sector-ratios-hist" class="quarto-xref">Figure&nbsp;6</a>). Virginia’s utilities show distinct distributional patterns compared with the rest of the U.S. (Figure <a href="#fig-sector-ratios-va-vs-others" class="quarto-xref">Figure&nbsp;7</a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-sector-ratios-hist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sector-ratios-hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-sector-ratios-hist-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sector-ratios-hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Distribution of key electricity sector ratios across all U.S. utilities in 2023.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-sector-ratios-va-vs-others" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sector-ratios-va-vs-others-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-sector-ratios-va-vs-others-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sector-ratios-va-vs-others-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Comparison of sector ratios between Virginia utilities and all other U.S. utilities in 2023.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure <a href="#fig-customer-intensity-va-vs-others" class="quarto-xref">Figure&nbsp;8</a> shows that Virginia utilities generally have higher per-customer intensity levels, especially for commercial customers.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-customer-intensity-va-vs-others" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-customer-intensity-va-vs-others-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-customer-intensity-va-vs-others-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-customer-intensity-va-vs-others-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Comparison of per-customer electricity intensity measures for Virginia utilities versus all other U.S. utilities (2023). Values shown on a log scale.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure <a href="#fig-sales-vs-customers-2023" class="quarto-xref">Figure&nbsp;9</a> shows how Virginia utilities compare to national utilities in overall system size and total electricity demand.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-sales-vs-customers-2023" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sales-vs-customers-2023-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-sales-vs-customers-2023-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sales-vs-customers-2023-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Relationship between total customers and total electricity sales (log–log scale) for U.S. utilities in 2023, highlighting Virginia utilities.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure <a href="#fig-commercial-ratio-spc-2023" class="quarto-xref">Figure&nbsp;10</a> highlights the commercial load structure and intensity for Virginia relative to other states.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-commercial-ratio-spc-2023" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-commercial-ratio-spc-2023-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-commercial-ratio-spc-2023-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-commercial-ratio-spc-2023-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Commercial sector structure versus commercial sales per customer (log scale) for U.S. utilities in 2023, with Virginia utilities highlighted.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure <a href="#fig-va-vs-us-salespercustomer" class="quarto-xref">Figure&nbsp;11</a> shows how Virginia’s average electricity intensity per customer compares to the national trend from 2015–2024.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-va-vs-us-salespercustomer" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-va-vs-us-salespercustomer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-va-vs-us-salespercustomer-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-va-vs-us-salespercustomer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Average electricity sales per customer over time (2015–2024), comparing Virginia to all other U.S. states.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure <a href="#fig-va-vs-us-commercialratio" class="quarto-xref">Figure&nbsp;12</a> illustrates how Virginia’s commercial load share differs from the rest of the U.S. over time.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-va-vs-us-commercialratio" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-va-vs-us-commercialratio-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-va-vs-us-commercialratio-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-va-vs-us-commercialratio-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Average commercial electricity sales ratio over time (2015–2024), comparing Virginia to all other U.S. states.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="research-questions" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="research-questions"><span class="header-section-number">4</span> Research Questions</h2>
<p>For this analysis we wanted to be able to answer the following questions:</p>
<ol type="1">
<li><p>Can we classify which utilities exhibit “data-center–like” load characteristics based on commercial intensity and per-customer electricity usage?</p></li>
<li><p>How does Virginia compare nationally in the proportion and concentration of high-demand utilities?</p></li>
<li><p>Which states show strong dominance of high-load utilities when weighted by retail sales, customer base, and commercial sales volume?</p></li>
</ol>
<section id="building-classifiers" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="building-classifiers"><span class="header-section-number">4.1</span> Building Classifiers</h3>
<p>In this section we explore methods that will enable us to classify which utilities exhibit “data-center–like” load characteristics based on commercial intensity and per-customer electricity usage. In particular we look at various models including logistic regression, KNN, trees and random forests that will later enable us to not only identify utilities for the year we trained on but also generalize to other years. And lastly we look at some clustering methods using PCA and K-means.</p>
<p>For all models we split our data into training and test sets using a 20% hold out for testing. We set a random seed of 123 which should allow us to have consistent results. We also use our featurize method to do feature engineering yielding out high demand characteristic features mentioned in the Data section.</p>
<p>Figure <a href="#fig-high-demand-distribution" class="quarto-xref">Figure&nbsp;13</a> shows the distribution of high demand utilities across the country for 2023. This is after we do feature engineering on our data set. As you can see there are a very small number of high demand utilities.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-high-demand-distribution" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-high-demand-distribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-high-demand-distribution-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-high-demand-distribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Distribution of high demand utilities for (2023)
</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure <a href="#fig-dist-of-predictors-original-scale" class="quarto-xref">Figure&nbsp;14</a> illustrates how each of our feature engineered predictor variables of Commercial_Ratio, Commercial_SPC, Losses_Ratio, and SalesPerCustomer are highly skewed without any data transformations.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dist-of-predictors-original-scale" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dist-of-predictors-original-scale-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-dist-of-predictors-original-scale-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dist-of-predictors-original-scale-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: Distributions of Predictors (original scale)
</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure <a href="#fig-dist-of-predictors-log10-scale" class="quarto-xref">Figure&nbsp;15</a> now shows that with a log10 transformation, our feature engineered predictor variables all exhibit much more clearer and interpretable distributions.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dist-of-predictors-log10-scale" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dist-of-predictors-log10-scale-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-dist-of-predictors-log10-scale-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dist-of-predictors-log10-scale-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: Distributions of Predictors (log10 scale)
</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure <a href="#fig-boxplots-by-highdemand" class="quarto-xref">Figure&nbsp;16</a> displays boxplots of our 5 predictors, separated by demand class. Note that while observing these boxplots, we can see that the high demand class is often correlated with much higher average Commercial_Ratio values, as well as lower average Losses_Ratio and log_Total_Customers values.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-boxplots-by-highdemand" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplots-by-highdemand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-boxplots-by-highdemand-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplots-by-highdemand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: Boxplots of Predictors by High-Demand Class (2023)
</figcaption>
</figure>
</div>
</div>
</div>
<section id="logistic-regression" class="level4" data-number="4.1.1">
<h4 data-number="4.1.1" class="anchored" data-anchor-id="logistic-regression"><span class="header-section-number">4.1.1</span> Logistic Regression</h4>
<p>We first look at the unpenalized logistic regression model. This model attempted to estimate how well our utility characteristics predict whether a utility falls into the high demand or high intensity distribution (HighDemand = 1). Although the model achieved high classification accuracy, the coefficient estimates were extremely large, indicating numerical instability. This occurs when predictors nearly perfectly separate HighDemand from non-HighDemand utilities. In such cases, the logistic maximum likelihood estimator pushes coefficients toward infinity, producing inflated parameter estimates and artificially tiny p-values. This makes interpreting Model <a href="#eq-rawlogitmodel" class="quarto-xref">Equation&nbsp;1</a> difficult.</p>
<p>Due to this instability, the individual coefficients cannot be interpreted in terms of effect sizes, odds ratios, or directionality. The model is useful only as a classifier but not as an explanatory model. The extreme magnitudes also reflect high multicollinearity among engineered intensity variables, differences in scale, and the presence of many dummy variables for utility type categories. These limitations motivate the use of penalized logistic regression or simpler composite scoring methods for more stable and interpretable results which we will explore later.</p>
<p>See the results of this model in <a href="#tbl-confusion-rawlogitmodel" class="quarto-xref">Table&nbsp;1</a>.</p>
<p>As shown in Model <a href="#eq-rawlogitmodel" class="quarto-xref">Equation&nbsp;1</a>, the probability of a utility being classified as high-demand depends on several structural and commercial intensity features.</p>
<p><span id="eq-rawlogitmodel"><span class="math display">\[
\begin{aligned}
\Pr(Y_i = 1 \mid X_i)
&amp;= \frac{1}{1 + \exp(-\eta_i)} \\
\\
\eta_i =\;
&amp;\beta_0
+ \beta_1\,\text{Commercial Ratio}_i \\
&amp;+ \beta_2\,\text{Sales per Customer}_i \\
&amp;+ \beta_3\,\text{Commercial SPC}_i \\
&amp;+ \beta_4\,\text{Losses Ratio}_i \\
&amp;+ \beta_5\,\log(\text{Total Customers}_i) \\
&amp;+ \beta_6\,\text{is VA}_i \\
&amp;+ \sum_k \gamma_k\,\text{Utility Type}_{ik}
\end{aligned}
\tag{1}\]</span></span></p>
<div class="cell">
<div id="tbl-confusion-rawlogitmodel" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-confusion-rawlogitmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Confusion Matrix for Unpenalized Logistic Regression Model (Test Set)
</figcaption>
<div aria-describedby="tbl-confusion-rawlogitmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<caption>Confusion Matrix</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">0</th>
<th style="text-align: center;">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: center;">274</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">33</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Classification.Accuracy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.9777</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The standardized logistic regression model <a href="#eq-stdlogitmodel" class="quarto-xref">Equation&nbsp;2</a> replaces the raw intensity variables with their z-scores while keeping the same outcome (HighDemand_intensity) and covariates (is_VA and Utility.Type). Standardization improves numerical conditioning and makes predictors comparable in principle, but in this case the fitted model still shows extremely large coefficient estimates and tiny p-values for all terms. This indicates that the underlying problem has not been resolved.</p>
<p><span class="math display">\[
\Pr(Y_i = 1 \mid X_i)
= \frac{1}{1 + \exp(-\eta_i)}
\]</span></p>
<p><span id="eq-stdlogitmodel"><span class="math display">\[
\begin{aligned}
\eta_i =\;
&amp;\beta_0
+ \beta_1\,z\!\left(\text{Commercial Ratio}_i\right)
+ \beta_2\,z\!\left(\text{Sales per Customer}_i\right) \\
&amp;+ \beta_3\,z\!\left(\text{Commercial SPC}_i\right)
+ \beta_4\,z\!\left(\text{Losses Ratio}_i\right)
+ \beta_5\,z\!\left(\log(\text{Total Customers}_i)\right) \\
&amp;+ \beta_6\,\text{is VA}_i
+ \sum_k \gamma_k\,\text{Utility Type}_{ik}
\end{aligned}
\tag{2}\]</span></span></p>
<p>As with the unstandardized model, this standardized specification achieves high classification accuracy on the test set (about 97.8% see <a href="#tbl-confusion-stdlogitmodel" class="quarto-xref">Table&nbsp;2</a>), but the individual coefficients cannot be interpreted as meaningful effect sizes or odds ratios. The model is functioning as an overfit classifier rather than a stable explanatory model. In practice, this motivates relying on penalized models, simpler composite indices, and descriptive comparisons.</p>
<div class="cell">
<div id="tbl-confusion-stdlogitmodel" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-confusion-stdlogitmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Confusion Matrix for Standardized Logistic Regression Model (Test Set)
</figcaption>
<div aria-describedby="tbl-confusion-stdlogitmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<caption>Confusion Matrix (Standardized Logistic Model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">0</th>
<th style="text-align: center;">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: center;">274</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">33</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Classification.Accuracy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.9777</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>To address the instability observed in the unpenalized logistic regression models, we fit a Ridge-penalized logistic regression using cross-validation. Ridge regression introduces an L2 penalty on the magnitude of the coefficients, shrinking them toward zero and preventing the divergence that occurred in the raw and standardized models. We trained the model using 10-fold cross-validation, which automatically selects the value of the penalty parameter <span class="math inline">\(\lambda\)</span> that minimizes cross-validated deviance.</p>
<p>The Ridge model produces well-behaved coefficients and yields more reliable out-of-sample predictions. Unlike the previous models, Ridge does not aim to provide easily interpretable coefficients penalization introduces bias in exchange for substantial variance reduction but it provides a more stable and generalizable classifier. See <a href="#tbl-confusion-ridgelogitmodel" class="quarto-xref">Table&nbsp;3</a>.</p>
<p>Classification performance on the test set remains very strong, with an accuracy near 97–98%, similar to the unpenalized models. However, because the coefficients are shrunk and closely correlated predictors share weight, Ridge should be interpreted as a predictive model, not an explanatory one.</p>
<div class="cell">
<div id="tbl-confusion-ridgelogitmodel" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-confusion-ridgelogitmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Confusion Matrix for Ridge Logistic Regression Model (Test Set)
</figcaption>
<div aria-describedby="tbl-confusion-ridgelogitmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<caption>Confusion Matrix (Ridge Logistic Model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">0</th>
<th style="text-align: center;">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: center;">275</td>
<td style="text-align: center;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">22</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Classification.Accuracy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.9459</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The <a href="#tbl-logit-model-compare" class="quarto-xref">Table&nbsp;4</a> shows a comparison of the 3 different logistic classifier models.</p>
<div class="cell">
<div id="tbl-logit-model-compare" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-logit-model-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Comparison of Logistic Regression Models for High-Demand Classification
</figcaption>
<div aria-describedby="tbl-logit-model-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 18%">
<col style="width: 22%">
<col style="width: 20%">
<col style="width: 3%">
<col style="width: 8%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Model</th>
<th style="text-align: center;">Training.Issues</th>
<th style="text-align: center;">Interpretability</th>
<th style="text-align: center;">AIC</th>
<th style="text-align: center;">Test.Accuracy</th>
<th style="text-align: center;">Key.Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Raw Logistic Regression</td>
<td style="text-align: center;">Severe separation; coefficients explode</td>
<td style="text-align: center;">Poor (coefficients meaningless)</td>
<td style="text-align: center;">604.7</td>
<td style="text-align: center;">0.9777</td>
<td style="text-align: center;">Not reliable for inference; unstable estimates</td>
</tr>
<tr class="even">
<td style="text-align: center;">Standardized Logistic Regression</td>
<td style="text-align: center;">Still unstable; separation persists</td>
<td style="text-align: center;">Poor (scaled version of same issue)</td>
<td style="text-align: center;">604.7</td>
<td style="text-align: center;">0.9777</td>
<td style="text-align: center;">Standardization alone did not fix the problem</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Ridge Logistic Regression</td>
<td style="text-align: center;">Stable; L2 penalty prevents divergence</td>
<td style="text-align: center;">Moderate (penalized, but stable)</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">0.9459</td>
<td style="text-align: center;">Best predictive model; generalizes well</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="tree-classifier" class="level4" data-number="4.1.2">
<h4 data-number="4.1.2" class="anchored" data-anchor-id="tree-classifier"><span class="header-section-number">4.1.2</span> Tree Classifier</h4>
<p>Next, we created a tree classifier to predict high-demand utility status using key operational and customer predictors, including Commercial_Ratio, SalesPerCustomer, and Commercial_SPC. This tree model identifies decision rules that split the data into increasingly homogeneous groups, and its structure was visualized for interpretability, as shown in Figure <a href="#fig-tree" class="quarto-xref">Figure&nbsp;17</a>. Performance was evaluated on a test dataset using a confusion matrix and overall accuracy, comparing predicted classes with actual outcomes. See Table <a href="#tbl-confusion-treemodel" class="quarto-xref">Table&nbsp;5</a>.</p>
<p>Our tree classifier shows that Commercial_Ratio and Commercial_SPC are the strongest determinants of high-demand classification. The confusion matrix indicates only three misclassifications, resulting in an extremely high accuracy of over 99%, and the model effectively separates high-demand from normal-demand utilities with simple rules. A key benefit of this method is its easy interpretability; however, a notable drawback is that classification trees can be sensitive to small changes in data, which may reduce their stability.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-tree" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-tree-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: Classification Tree for High Demand Utilities
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div id="tbl-confusion-treemodel" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-confusion-treemodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Confusion Matrix for Tree Model (Test Set)
</figcaption>
<div aria-describedby="tbl-confusion-treemodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<caption>Confusion Matrix (Classification Tree Model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">0</th>
<th style="text-align: center;">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: center;">273</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">38</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Classification.Accuracy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.9904</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="random-forest" class="level4" data-number="4.1.3">
<h4 data-number="4.1.3" class="anchored" data-anchor-id="random-forest"><span class="header-section-number">4.1.3</span> Random Forest</h4>
<p>When compared to a single tree classifier, a random forest classification approach reduces variance and improves predictive stability. We constructed a random forest model that predicts high-demand utility status using operational and customer predictors, including Commercial_Ratio, SalesPerCustomer, Commercial_SPC, Losses_Ratio, log_Total_Customers, is_VA, and Utility.Type. The model was trained using 500 decision trees, with each tree built from a bootstrap sample of the training data and a randomized subset of predictors considered at each split. Variable importance measures were generated to highlight the most influential predictors, as shown in Figure <a href="#fig-rf" class="quarto-xref">Figure&nbsp;18</a>. The fitted model was then used to classify observations in the test dataset, and confusion matrix and an accuracy measure were computed to evaluate classification performance. See Table <a href="#tbl-confusion-randforestmodel" class="quarto-xref">Table&nbsp;6</a>.</p>
<p>The model’s out-of-bag error rate was extremely low (0.4%), indicating strong performance during training. Test results similarly reflect high predictive accuracy, with only four misclassifications out of the full test set and an overall accuracy of about 98.7%. The confusion matrix shows strong ability to correctly identify both high-demand and normal-demand utilities, demonstrating that the random forest generalizes well. Overall, the method provides robust and reliable classification with advantages such as reduced overfitting and strong predictive accuracy, though it is less interpretable than our simpler single tree classifier.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-rf" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-rf-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18: Random Forest Variable Importance
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div id="tbl-confusion-randforestmodel" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-confusion-randforestmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Confusion Matrix for Random Forest Model (Test Set)
</figcaption>
<div aria-describedby="tbl-confusion-randforestmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<caption>Confusion Matrix (Random Forest Model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">0</th>
<th style="text-align: center;">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: center;">273</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">37</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Classification.Accuracy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.9873</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="knn" class="level4" data-number="4.1.4">
<h4 data-number="4.1.4" class="anchored" data-anchor-id="knn"><span class="header-section-number">4.1.4</span> KNN</h4>
<p>K-Nearest Neighbors (KNN) analysis begins by selecting predictors and standardizing them using the mean and standard deviation calculated from the training data. This ensures that all features contribute equally to the distance calculations used by KNN. The standardized training data and corresponding class labels (HighDemand_intensity) are then used to classify each observation in the standardized test set by identifying the k=5 closest training points in feature space, and assigning the majority class among those neighbors. Finally, predictions are compared with actual test labels to generate a confusion matrix and accuracy measure, as shown in <a href="#tbl-knn" class="quarto-xref">Table&nbsp;7</a>.</p>
<p>The results show that the model correctly classified nearly all observations, incorrectly classifying only 10 out of 314 cases and achieving an accuracy of about 96.8%. The confusion matrix also indicates no false positives, suggesting the classifier is conservative and highly accurate for the High Demand class.</p>
<div class="cell">
<div id="tbl-knn" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-knn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: Confusion Matrix for KNN
</figcaption>
<div aria-describedby="tbl-knn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<caption>Confusion Matrix (KNN)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">0</th>
<th style="text-align: center;">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: center;">275</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">29</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Classification.Accuracy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.9682</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="pca-and-k-means-unsupervised-approach" class="level4" data-number="4.1.5">
<h4 data-number="4.1.5" class="anchored" data-anchor-id="pca-and-k-means-unsupervised-approach"><span class="header-section-number">4.1.5</span> PCA and K-means Unsupervised Approach</h4>
<p>Principal Component Analysis (PCA) was used to identify the dominant structural patterns in the engineered utility features. This approach is non-parametric and unsupervised so cannot be compared to other models explored. However, it can give us more insight into various patterns within the data.</p>
<p>The first two principal components explained a large share of total variance, indicating that most variation in utility intensity can be summarized in two latent dimensions. See the PCA Scree Plot <a href="#tbl-pca-scree" class="quarto-xref">Table&nbsp;8</a>.</p>
<p>Just for reference:</p>
<p><strong>PC1</strong> = Commercial intensity axis i.e.&nbsp;Commercial Ratio &amp; Log(Total Customers)</p>
<p><strong>PC2</strong> = Customer scale axis i.e.&nbsp;SalesPerCustomer &amp; Commercial SPC</p>
<div class="cell">
<div id="tbl-pca-scree" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-pca-scree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: PCA Scree Plot
</figcaption>
<div aria-describedby="tbl-pca-scree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="power_files/figure-html/tbl-pca-scree-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>In the PCA scatter plot <a href="#tbl-pca" class="quarto-xref">Table&nbsp;9</a>, high‐demand utilities tend to occupy distinct regions of PC space, demonstrating that the engineered ratios and per-customer metrics capture meaningful behavioral differences. The plot shows High-demand utilities are far right on PC1. Virginia utilities are spread out and not concentrated in the high-intensity clusters.</p>
<div class="cell">
<div id="tbl-pca" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-pca-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9: PCA
</figcaption>
<div aria-describedby="tbl-pca-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="power_files/figure-html/tbl-pca-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>K-means clustering (see <a href="#tbl-kemans" class="quarto-xref">Table&nbsp;10</a>) applied to the first three PCs further revealed that utilities naturally group into clusters corresponding to intensity characteristics. One cluster contained a disproportionate share of high-demand utilities, confirming that their behavior is structurally different from typical utilities. When examining Virginia utilities, several appear near the edges of clusters, suggesting that Virginia’s utilities exhibit more extreme or atypical load patterns relative to national norms. PCA + K-means shows Virginia does NOT cluster with high-intensity utilities. Only Dominion and NoVA co-ops show mild PC1 shifting — but not enough to enter the high-intensity group.</p>
<div class="cell">
<div id="tbl-kemans" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-kemans-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10: PCA and K-means Clustering
</figcaption>
<div aria-describedby="tbl-kemans-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="power_files/figure-html/tbl-kemans-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>Overall, PCA reveals that Virginia utilities do not form a distinct high-intensity cluster. Instead, they occupy mid-range positions in the commercial-load space, consistent with a mixed customer base rather than pure commercial concentration.</p>
</section>
<section id="model-comparison-summary" class="level4" data-number="4.1.6">
<h4 data-number="4.1.6" class="anchored" data-anchor-id="model-comparison-summary"><span class="header-section-number">4.1.6</span> Model Comparison Summary</h4>
<p>Both ridge logistic and random forest models reliably identify utilities with unusually intense commercial electricity usage. See <a href="#tbl-model-summary" class="quarto-xref">Table&nbsp;11</a>.</p>
<div class="cell">
<div id="tbl-model-summary" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11: Model Summary
</figcaption>
<div aria-describedby="tbl-model-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed do-not-create-environment cell caption-top table-sm small" data-quarto-postprocess="true">
<caption>Model Performance Comparison</caption>
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Accuracy</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Logistic Regression (Raw)</td>
<td style="text-align: center;">0.9777</td>
<td style="text-align: center;">Coefficient explosion; separation issues</td>
</tr>
<tr class="even">
<td style="text-align: center;">Logistic Regression (Scaled)</td>
<td style="text-align: center;">0.9777</td>
<td style="text-align: center;">Still unstable but standardized</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Ridge Logistic Regression</td>
<td style="text-align: center;">0.9459</td>
<td style="text-align: center;">Most stable logistic model; good generalization</td>
</tr>
<tr class="even">
<td style="text-align: center;">Classification Tree</td>
<td style="text-align: center;">0.9904</td>
<td style="text-align: center;">Low-variance, simple interpretable model</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Random Forest</td>
<td style="text-align: center;">0.9873</td>
<td style="text-align: center;">Highest-performing tree-based model</td>
</tr>
<tr class="even">
<td style="text-align: center;">KNN (k = 5)</td>
<td style="text-align: center;">0.9682</td>
<td style="text-align: center;">Sensitive to scaling; depends on local structure</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
<section id="predictive-modeling-of-high-load-utility-distribution-and-state-level-dominance" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="predictive-modeling-of-high-load-utility-distribution-and-state-level-dominance"><span class="header-section-number">4.2</span> Predictive Modeling of High-Load Utility Distribution and State-Level Dominance</h3>
<p>Now that we have built several models we want to utilize those models to answer our remaining research questions:</p>
<ol type="1">
<li>How does Virginia compare nationally in the proportion and concentration of high-demand utilities?</li>
<li>Which states show strong dominance of high-load utilities when weighted by retail sales, customer base, and commercial sales volume?</li>
</ol>
<section id="methodology" class="level4" data-number="4.2.1">
<h4 data-number="4.2.1" class="anchored" data-anchor-id="methodology"><span class="header-section-number">4.2.1</span> Methodology</h4>
<p>To answer these questions, we first considered our trained ridge-penalized logistic regression model trained on 2023 utility-level data to classify each utility as either high-demand or normal-demand based on our engineered intensity features. We then applied this fitted model, along with a random forest classifier, to out-of-sample years (2018 and 2023) by re-featurizing the EIA-861 data for each year and carefully aligning factor levels and matrix columns with the original training set. This produced a combined dataset (classified_all) containing predicted high-demand labels for every utility, year, and state. From this, we constructed state-level summaries:</p>
<ol type="i">
<li><p>the proportion of utilities classified as high-demand (to measure concentration), and</p></li>
<li><p>a composite Data Center Load Index (DCLI) <a href="#eq-dcli" class="quarto-xref">Equation&nbsp;3</a> that averages the share of total retail sales, customers, and commercial sales served by high-demand utilities (to measure dominance). The resulting state-level proportions and DCLI values were then visualized to compare Virginia’s position to that of other states.</p></li>
</ol>
<p><span id="eq-dcli"><span class="math display">\[
\text{DCLI}_s
=
\frac{
\left(
\frac{\text{HighSales}_s}{\text{TotalSales}_s}
\right)
+
\left(
\frac{\text{HighCustomers}_s}{\text{TotalCustomers}_s}
\right)
+
\left(
\frac{\text{HighCommercialSales}_s}{\text{TotalCommercialSales}_s}
\right)
}{3}
\tag{3}\]</span></span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\mathcal{U}_s\)</span> = set of <strong>all utilities</strong> in state <span class="math inline">\(s\)</span><br>
</li>
<li><span class="math inline">\(\mathcal{H}_s \subset \mathcal{U}_s\)</span> = subset of <strong>high-demand utilities</strong> in state <span class="math inline">\(s\)</span><br>
</li>
<li><em>Sales</em> = total annual retail electricity sales<br>
</li>
<li><em>Customers</em> = total annual number of customers<br>
</li>
<li><em>CommSales</em> = total annual <strong>commercial-sector</strong> electricity sales</li>
</ul>
</section>
<section id="results" class="level4" data-number="4.2.2">
<h4 data-number="4.2.2" class="anchored" data-anchor-id="results"><span class="header-section-number">4.2.2</span> Results</h4>
<p>As can be seen in <a href="#fig-results-proportion" class="quarto-xref">Figure&nbsp;19</a>, across all states, we find that Virginia does not emerge as the single most extreme state in terms of the number of utilities classified as high-demand. Instead, it ranks roughly tenth, placing it in the top ten nationally. This means that Virginia’s utility mix is unmistakably more “high-intensity” than that of the typical U.S. state, but several states exhibit even higher concentrations of load-intensive utilities. These findings indicate that while Virginia is a key center of high-demand electricity usage, it is not unique in having utilities that show strong commercial and per-customer intensity profiles.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-results-proportion" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-results-proportion-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-results-proportion-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-results-proportion-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19: Proportion of high-demand utilities (Virginia vs national) - Ridge Model
</figcaption>
</figure>
</div>
</div>
</div>
<p>However, simple utility counts do not reflect overall dominance, because not all utilities are equal in size or influence. To address this, we constructed the Data Center Load Index (DCLI) a composite metric averaging the retail-sales-weighted, customer-weighted, and commercial-sales-weighted share of total load served by high-demand utilities. This index captures not just how many high-demand utilities a state has, but how important they are to the state’s power demand. As can be seen in <a href="#fig-results-dcli" class="quarto-xref">Figure&nbsp;20</a> under the DCLI, Virginia again appears in the upper tier of states, but is outpaced by a handful of states where one or two utilities dominate nearly the entire statewide load. Importantly, several of these top-ranked states are not traditional data center hubs, suggesting that our intensity-based classification is detecting a broader category of industrial and commercial high-load behavior not only hyperscale data centers.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-results-dcli" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-results-dcli-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="power_files/figure-html/fig-results-dcli-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-results-dcli-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20: High-demand utility concentration and weighted dominance across states, highlighting Virginia.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="discussion-limitations" class="level4" data-number="4.2.3">
<h4 data-number="4.2.3" class="anchored" data-anchor-id="discussion-limitations"><span class="header-section-number">4.2.3</span> Discussion &amp; Limitations</h4>
<p>The DCLI reveals why Virginia ranks highly even though it has relatively few high-demand utilities. Virginia’s electricity system is anchored by a small number of extremely large utilities, most notably Dominion Energy and NOVEC. If one of these utilities is classified as high-demand, it automatically commands a very large share of total statewide sales and customers. In other words:</p>
<p><strong>Virginia is not dominated by many high-demand utilities—it is dominated by a few enormous ones.</strong></p>
<p>This explains Virginia’s strong DCLI ranking: high-demand load is concentrated inside a small number of massive utilities, rather than spread across many smaller ones as occurs in other states. By contrast, states like New York exhibit a high count of high-demand utilities, but these tend to be relatively small; their DCLI drops sharply once weighted by load. Other states appear at the top of the rankings due to industrial intensity where load patterns resemble the characteristics of our “high-demand” classification even though they are not data center hubs.</p>
<p>These findings highlight both the strength and the limits of using utility-level EIA-861 data as a proxy for identifying data-center-like demand. Because the dataset does not identify data centers explicitly, the “high-demand” class inevitably captures a mixture of true hyperscale activity and unrelated high-load commercial or industrial customers. Rather than contradicting Virginia’s well-documented role as the world’s largest data center market, the results show that when we zoom out to a national, utility-level lens, data-center-like load is part of a broader pattern of concentrated high-intensity commercial usage across the United States.</p>
<p>Bringing everything together, the proportional rankings and DCLI analysis provide a consistent story: Virginia stands out as one of the nation’s most high-demand states not because it has many high-demand utilities, but because the few that it does have carry enormous weight. When considering both concentration and dominance, Virginia emerges clearly as a high-intensity electricity state whose load structure reflects the presence of major hyperscale data center activity layered onto large, diversified utility territories.</p>
</section>
</section>
</section>
<section id="conclusion" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">5</span> Conclusion</h2>
<p>After diving through in-depth analyses and providing detailed explanations for each of our research questions, let us circle back and revisit all of our research questions at once, providing some more succinct and summarizing answers to kickoff our conclusions.</p>
<p>Research Question 1: Can we classify which utilities exhibit “data-center–like” load characteristics based on commercial intensity and per-customer electricity usage?</p>
<ul>
<li>Answer Summary: By first creating a handful of engineered variables derived from the original dataset, we built a number of classifiers to identify which utilities exhibit “data-center-like,” or in other words high-demand, load characteristics utilizing multiple methodologies. After building classifiers with logistic regression, standardized logistic regression, ridge logistic regression, single tree classification, random forest, and K-nearest-neighbors approaches and comparing their models, we deduced that the ridge logistic regression model is the most stable, while the random forest model is the highest performing tree based approach, making either choice highly suitable to reliably classify utilities with unusually high demand.</li>
</ul>
<p>Research Question 2: How does Virginia compare nationally in the proportion and concentration of high-demand utilities?</p>
<ul>
<li>Answer Summary: When applying our ridge logistic regression model along with a random forest classifier to the data, we find that the state of Virginia ranks roughly tenth in the nation in terms of the proportion of utilities classified as high-demand.</li>
</ul>
<p>Research Question 3: Which states show strong dominance of high-load utilities when weighted by retail sales, customer base, and commercial sales volume?</p>
<ul>
<li>Answer Summary: Again utilizing our ridge logistic regression and random forest model, we then created an index that combines a state’s number of high-demand utilities and their importance to the state’s power demand. From this index, we could more accurately compare the dominance of high-load utilities between states, and we find that states of Nevada, Tennessee, Colorado, and Virginia, among other states exhibit the strongest dominance of high-load utilities, where a lower number of utilities dominate more of the state’s total load.</li>
</ul>
<p>Furthermore, this study illustrates the broader conclusion that utility-level EIA-861 data, despite lacking explicit data-center identifiers, can still reveal meaningful data-center–like electricity demand patterns when combined with structural load metrics, machine-learning classifiers, and weighted dominance indices such as the DCLI. Our results show that Virginia consistently ranks within the upper tier of states in both the proportion and dominance of high-demand utilities, though it is not the single most extreme case nationally. Instead, Virginia’s position is driven by a small number of very large utilities whose load profiles heavily influence statewide metrics—highlighting that intensity and dominance do not always correspond to the number of high-demand utilities alone.</p>
<p>Key insights gained from this study include:</p>
<ul>
<li><p>High-demand utility behavior is not unique to traditional data-center states; several states exhibit strong commercial or industrial load intensity unrelated to hyperscale development.</p></li>
<li><p>Virginia’s system stands out not because it has many high-demand utilities, but because its few high-intensity utilities represent a disproportionately large share of statewide load.</p></li>
<li><p>Weighted metrics such as the DCLI provide a more accurate picture of systemic dominance than simple counts of high-demand utilities.</p></li>
</ul>
<p>Future considerations:</p>
<ul>
<li><p>More granular data such as substation-level load, hourly consumption, or direct data-center reporting would improve classification accuracy and help isolate genuine data-center demand from other high-load sectors.</p></li>
<li><p>Incorporating temporal dynamics through time-series models could reveal how high-demand behavior evolves as data-center growth accelerates.</p></li>
<li><p>Additional feature engineering or alternative classification approaches may help reduce noise in states where industrial load patterns resemble data-center behavior.</p></li>
</ul>
<p>Overall, this framework provides a scalable foundation for tracking evolving electricity demand pressures and assessing how data-center–like load patterns shape the resilience and planning needs of state-level power systems.</p>
</section>
<section id="references" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="references"><span class="header-section-number">6</span> References</h2>




</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list">
<div id="ref-data-center-capital" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">C. Six, <span>“How did virginia become the data center capital of the world?”</span> <a href="https://wydaily.com/latest/regional-national/2025/11/07/how-did-virginia-become-the-data-center-capital-of-the-world/" class="uri">https://wydaily.com/latest/regional-national/2025/11/07/how-did-virginia-become-the-data-center-capital-of-the-world/</a>; Williamsburg Yorktown Daily, Nov. 2025.</div>
</div>
<div id="ref-dawn-of-data" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">Virginia Economic Development Partnership, <span>“The dawn of data.”</span> <a href="https://www.vedp.org/news/dawn-data" class="uri">https://www.vedp.org/news/dawn-data</a>, 2019.</div>
</div>
<div id="ref-cushman" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">A. Data, <span>“Americas data center update H1 2025.”</span> <a href="https://digital.cushmanwakefield.com/Americas-Data-Center-H1-2025-Update/" class="uri">https://digital.cushmanwakefield.com/Americas-Data-Center-H1-2025-Update/</a>; Cushman &amp; Wakefield, 2025.</div>
</div>
<div id="ref-power-grid" class="csl-entry" role="listitem">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">U.S. Energy Information Administration, <span>“Delivery to consumers – u.s. Energy information administration (EIA).”</span> <a href="https://www.eia.gov/energyexplained/electricity/delivery-to-consumers.php" class="uri">https://www.eia.gov/energyexplained/electricity/delivery-to-consumers.php</a>; EIA, 2016.</div>
</div>
<div id="ref-original-eia-data" class="csl-entry" role="listitem">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">U.S. Energy Information Administration, <span>“<span class="nocase">EIA-861 Annual Electric Power Industry Report, detailed data files</span>.”</span> Online dataset, 2025. Available: <a href="https://www.eia.gov/electricity/data/eia861/">https://www.eia.gov/electricity/data/eia861/</a></div>
</div>
<div id="ref-data-dictionary" class="csl-entry" role="listitem">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline">CORGIS Dataset Project, <span>“<span class="nocase">CORGIS Electricity Dataset (2017 data) – electricity.csv</span>.”</span> Online dataset, version 2.0.0, 2021. Available: <a href="https://corgis-edu.github.io/corgis/csv/electricity/">https://corgis-edu.github.io/corgis/csv/electricity/</a></div>
</div>
<div id="ref-power-loss" class="csl-entry" role="listitem">
<div class="csl-left-margin">[7] </div><div class="csl-right-inline">U.S. Energy Information Administration, <span>“How much electricity is lost in electricity transmission and distribution in the united states?”</span> <a href="https://www.eia.gov/tools/faqs/faq.php?id=105&amp;t=3" class="uri">https://www.eia.gov/tools/faqs/faq.php?id=105&amp;t=3</a>, 2016.</div>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>A hyperscaler is a company that operates massive-scale data centers to provide large-scale cloud computing services, like computing, storage, and networking, that can be rapidly scaled to meet fluctuating demand.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>https://corgis-edu.github.io/corgis/csv/electricity/<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Transmission and distribution losses represent the electricity that is generated but never reaches customers. This energy is lost as heat in power lines and transformers as it travels across the grid.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/jonathanwilsonami\.github\.io\/stat-515\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © 2025 Jonathan Wilson
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jonathanwilsonami/">
      <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>